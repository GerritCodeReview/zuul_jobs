{
  "comments": [
    {
      "key": {
        "uuid": "ed35a023_842e1ebc",
        "filename": "playbooks/test-gerrit-base.yaml",
        "patchSetId": 9
      },
      "lineNbr": 20,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2020-02-14T06:56:44Z",
      "side": 1,
      "message": "will this also work on branches that don\u0027t have all of these submodules?",
      "range": {
        "startLine": 8,
        "startChar": 8,
        "endLine": 20,
        "endChar": 25
      },
      "revId": "de85df8b8d6427d663e90e837ec4c92784523798",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c74b401_8e087efd",
        "filename": "playbooks/test-gerrit-base.yaml",
        "patchSetId": 9
      },
      "lineNbr": 20,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2020-02-14T17:18:25Z",
      "side": 1,
      "message": "This particular playbook is part of a test job that just exercises the role, and it\u0027s only set up to run on master.  But the problem you point to is general -- the setup role run by the gerrit-base job is naive and will copy all of the supplied repos into place.  Vitaliy has a good suggestion about how to avoid copying repos which aren\u0027t needed on specific branches.  We should probably implement something like that, but in the mean time, we can make branch-specific variants of the gerrit-base job which only include the necessary repos for that branch.",
      "parentUuid": "ed35a023_842e1ebc",
      "range": {
        "startLine": 8,
        "startChar": 8,
        "endLine": 20,
        "endChar": 25
      },
      "revId": "de85df8b8d6427d663e90e837ec4c92784523798",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fcd9826d_664a3b13",
        "filename": "playbooks/test-gerrit-base.yaml",
        "patchSetId": 9
      },
      "lineNbr": 20,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2020-02-17T09:35:34Z",
      "side": 1,
      "message": "If we have branch-specific variants, would it make sense to reflect the branches used in Gerrit also in zuul/jobs? So that we manage builds for Gerrit stable-2.16 in a stable-2.16 branch of zuul/jobs?",
      "parentUuid": "1c74b401_8e087efd",
      "range": {
        "startLine": 8,
        "startChar": 8,
        "endLine": 20,
        "endChar": 25
      },
      "revId": "de85df8b8d6427d663e90e837ec4c92784523798",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea2ba860_b5a394bd",
        "filename": "roles/prepare-gerrit-repos/tasks/repo.yaml",
        "patchSetId": 9
      },
      "lineNbr": 41,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2020-02-14T06:56:44Z",
      "side": 1,
      "message": "whitespace",
      "range": {
        "startLine": 41,
        "startChar": 0,
        "endLine": 41,
        "endChar": 4
      },
      "revId": "de85df8b8d6427d663e90e837ec4c92784523798",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5d841731_6f334659",
        "filename": "roles/prepare-gerrit-repos/tasks/repo.yaml",
        "patchSetId": 9
      },
      "lineNbr": 41,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2020-02-14T17:43:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ea2ba860_b5a394bd",
      "range": {
        "startLine": 41,
        "startChar": 0,
        "endLine": 41,
        "endChar": 4
      },
      "revId": "de85df8b8d6427d663e90e837ec4c92784523798",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3f27a3b7_51355694",
        "filename": "zuul.d/jobs.yaml",
        "patchSetId": 9
      },
      "lineNbr": 23,
      "author": {
        "id": 1011123
      },
      "writtenOn": "2020-02-14T06:56:44Z",
      "side": 1,
      "message": "same here; does this work on branches that don\u0027t have all of these submodules?",
      "range": {
        "startLine": 8,
        "startChar": 4,
        "endLine": 23,
        "endChar": 0
      },
      "revId": "de85df8b8d6427d663e90e837ec4c92784523798",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f3a11dfc_5eaaf869",
        "filename": "zuul.d/jobs.yaml",
        "patchSetId": 9
      },
      "lineNbr": 23,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2020-02-14T17:22:13Z",
      "side": 1,
      "message": "Yeah, this is the key.  As written, this will copy all of those modules into place, which is great for master, but on stable branches we will probably end up with a surplus of modules.  The way we can fix that (prior to Vitaliy\u0027s implementation) is to make branch variants of this.  That would involve reducing the set of projects above into the set that is common across all branches, then adding something like:\n\n- job:\n    name: gerrit-base\n    branches: stable/3.0\n    required-projects:\n      - (additional projects only on 3.0 branch)\n\nBut we can defer that for a little bit -- we can get this working for master then refactor for other branches without disruption.",
      "parentUuid": "3f27a3b7_51355694",
      "range": {
        "startLine": 8,
        "startChar": 4,
        "endLine": 23,
        "endChar": 0
      },
      "revId": "de85df8b8d6427d663e90e837ec4c92784523798",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}