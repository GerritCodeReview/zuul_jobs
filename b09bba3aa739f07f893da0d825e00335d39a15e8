{
  "comments": [
    {
      "key": {
        "uuid": "08c6f9af_a2fbc443",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 10,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-04-03T07:15:19Z",
      "side": 1,
      "message": "I don\u0027t understand how this is achieved, can you elaborate? \n\nOn RBE based build, that is still our goal for Zuul CI toolchain, Bazel would do that for you, extensively using Bazel Remote cache behind the scenes. So that in case of some changes in contrib directory, that is not contributing in any way to the final artifacts or influence test outcome, the command:\n\n  $ bazel test //...\n\nwould be a no op.",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 10,
        "endChar": 61
      },
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ace6342d_f6dd2181",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 10,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2020-04-03T14:13:05Z",
      "side": 1,
      "message": "This has nothing to do with RBE, or caching, or changes to gerrit.\n\nThere is a job called \"gerrit-build\".  Its purpose is to build and test changes to the gerrit repo.  Normally I would define that in the gerrit repo, and if we needed to make changes to the job, I would propose a patch to the gerrit repo and Zuul would run the job with the change.  However, since it has been requested that we include only the minimum amount of job configuration in-repo, most of that job is actually defined in *this* repo.\n\nSo when we make changes to the parts of that job that are in this repo, we still want to run the job in order to test that the changes work.  So there are four more jobs, each prefixed with \"test-\" and suffixed with branch names like \"-master\" or \"stable-3.1\".  They run the full gerrit build and test, simulating what would happen on each of the four branches of the gerrit repo.  That\u0027s how we verify that changes to the gerrit-build job work.\n\nCurrently, they run on every single change to this repo, however, there are other jobs in this repo, including the \"gerrit-build-plugin\" job.  It\u0027s different enough that it\u0027s possible to make a change to that job without changing anything that affects the \"gerrit-build\" job.  If we do that, we can save some time by not running four copies of the \"gerrit-build\" job along with the \"gerrit-plugin-build\" job (which we do want to run because that\u0027s what we\u0027re changing).\n\nThat\u0027s what this change does.  It says, \"if you\u0027re making a change to this repo, and you aren\u0027t touching any files that are used by the gerrit-build job, then don\u0027t run the test-gerrit-build-* jobs\".",
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6dba58b9_15bcd006",
        "filename": "zuul.d/test-jobs.yaml",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-04-03T15:37:36Z",
      "side": 1,
      "message": "Just to be sure I understand it correctly: this addition would have the effect, that this job will run, if some of these files are changed?",
      "range": {
        "startLine": 65,
        "startChar": 4,
        "endLine": 69,
        "endChar": 27
      },
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dd05300b_12ca795b",
        "filename": "zuul.d/test-jobs.yaml",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2020-04-03T15:43:41Z",
      "side": 1,
      "message": "Exactly.  Maybe the best way to see it is to look at the last entry here: if we edit playbooks/gerrit/build.yaml, this job will run because it matches that.  If we edit playbooks/gerrit-plugin/build.yaml, the job above (on line 49) will run because of the file matcher on line 60.\n\nThe three jobs below will inherit these file lists as well.",
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "915fdf9a_82c3ed92",
        "filename": "zuul.d/test-jobs.yaml",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-04-03T15:46:26Z",
      "side": 1,
      "message": "Thanks for clarifying.",
      "parentUuid": "dd05300b_12ca795b",
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ab342594_37cd9b64",
        "filename": "zuul.d/test-jobs.yaml",
        "patchSetId": 1
      },
      "lineNbr": 69,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-04-03T15:46:26Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "6dba58b9_15bcd006",
      "range": {
        "startLine": 65,
        "startChar": 4,
        "endLine": 69,
        "endChar": 27
      },
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19da537f_a068f841",
        "filename": "zuul.d/test-jobs.yaml",
        "patchSetId": 1
      },
      "lineNbr": 84,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-04-08T20:42:47Z",
      "side": 1,
      "message": "Can we define a template like in JJB and reuse it with different variables?",
      "range": {
        "startLine": 71,
        "startChar": 0,
        "endLine": 84,
        "endChar": 34
      },
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "52cdb931_b3d92b50",
        "filename": "zuul.d/test-jobs.yaml",
        "patchSetId": 1
      },
      "lineNbr": 84,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2020-04-08T21:58:32Z",
      "side": 1,
      "message": "This is basically the Zuul analog of that.  There isn\u0027t a templating system for jobs, instead we define a new job for each thing we want to test, inherit from a common job, and then override just the things we want to change.  It\u0027s different, but after years of using both, I find this to be easier and clearer, especially once you get past the trivial case (and I\u0027m responsible for the JJB templating system :).",
      "revId": "b09bba3aa739f07f893da0d825e00335d39a15e8",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}