{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f48e3d38_c5d475a5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2023-09-29T07:21:59Z",
      "side": 1,
      "message": "It looks like this change is in service of having this role support setting up submodules for more than just the gerrit repo.  It was named \"prepare-gerrit-repos\" to indicate its purpose was specifically to set up gerrit-related repos.  And note that gitiles *is* a submodule of gerrit.\n\nSo here are my concerns:\n\n1) Since gitiles *is* a submodule of gerrit, should it not be the case that we should run this role in its original intended configuration, to set up the gerrit repo with gitiles as a submodule and perform the build of gitiles in the context of gerrit?\n\n2) Since gitiles *also* has submodules of its own, perhaps we need a new role that performs similar submodule setup steps for the gitiles repo itself?\n\n3) If (and only if) we feel it is reasonable to expand the scope of the prepare-gerrit-repos role to support other repos, should we update the name and/or documentation to reflect that?  Note that the role does have extensive documentation explaining exactly what it does and the reasons why.  I worry that if we continue to change the scope without updating docs, they will be misleading.  Here is the docs link: https://gerrit.googlesource.com/zuul/jobs/+/refs/heads/master/roles/prepare-gerrit-repos/README.rst\n\nI\u0027m not sure I have delved into this in quite as much detail as Clark (and what I have done is with quite a bit more jetlag), but my initial thoughts are that because we have two sets of submodules to set up, we probably need two roles (or at least to run one role twice?).  Once for gerrit -\u003e gitiles, and again for gitiles -\u003e whatever.\n\nTo accomplish that, I could see us either expanding the scope of this role and invoking it twice, or making a new role.",
      "revId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67df6e83_ece79636",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2023-09-29T07:56:07Z",
      "side": 1,
      "message": "\u003e It looks like this change is in service of having this role support setting up submodules for more than just the gerrit repo. It was named \"prepare-gerrit-repos\" to indicate its purpose was specifically to set up gerrit-related repos. And note that gitiles is a submodule of gerrit.\n\nI think there is a confusion here. There are two different gitiles related repositories (https://gerrit-review.googlesource.com/admin/repos/q/filter:gitiles):\n\n* standalone gitiles project repository (that is not a submodule of gerrit): https://gerrit-review.googlesource.com/admin/repos/gitiles \n* gerrit-gitiles-plugin repository, that is one of the core gerrit plugins and as such is a submodule of gerrit: https://gerrit-review.googlesource.com/admin/repos/plugins/gitiles\n\nThis is added as gerrit submodule (https://gerrit.googlesource.com/gerrit/+/refs/heads/master/.gitmodules#25)\n\n```\n[submodule \"plugins/gitiles\"]\n\tpath \u003d plugins/gitiles\n\turl \u003d ../plugins/gitiles\n\tbranch \u003d .\n```\n\nAs we decided to re-use `prepare-gerrit-repos` role in gitiles job setup, the intention was: to have common/generic role, that is able to fetch submodules in addition to the main repository.\n\nOne possible fix to better communicate the intent would be to rename this role from `prepare-gerrit-repos` to something more generic: `prepare-project-with-submodules-repos`.\n\nHaving said that, I agree with what you\u0027ve just said: either we find a way to make this single role to work in different contexts and document it correspondingly, or we split it in two roles.",
      "parentUuid": "f48e3d38_c5d475a5",
      "revId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b0c25cb_4673f326",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2023-09-29T07:58:57Z",
      "side": 1,
      "message": "Ah, I was definitely confused by that, sorry, and thanks for the correction.  I agree that we can ignore that bit about having to run the role twice, and the only remaining concerns are just around whether we rename this and/or update the docs.",
      "parentUuid": "67df6e83_ece79636",
      "revId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9d49258c_2a0f96c7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1087826
      },
      "writtenOn": "2023-09-29T13:36:11Z",
      "side": 1,
      "message": "I think this bugfix is valid regardless of that (it could theoretically happen even in the expected use with Gerrit as the main project), so I don\u0027t think we need to tie any future renaming/docs updates to this.",
      "parentUuid": "8b0c25cb_4673f326",
      "revId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7f92d1f9_2a136027",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2023-09-29T13:42:36Z",
      "side": 1,
      "message": "üëç",
      "parentUuid": "9d49258c_2a0f96c7",
      "revId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153"
    }
  ],
  "submitRequirementResults": [
    {
      "submitRequirement": {
        "name": "Code-Review",
        "description": {
          "value": "Submit requirement for the \u0027Code-Review\u0027 label"
        },
        "applicabilityExpression": {},
        "submittabilityExpression": {
          "expressionString": "label:Code-Review\u003dMAX AND -label:Code-Review\u003dMIN"
        },
        "overrideExpression": {},
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {},
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Code-Review=MAX AND -label:Code-Review=MIN"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["label:Code-Review=MAX"],"failingAtoms":["label:Code-Review=MIN"]}
      },
      "overrideExpressionResult": {},
      "patchSetCommitId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Do-Not-Submit",
        "description": {
          "value": "Changes that have DO NOT SUBMIT in their commit message are not submittable."
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "message:\"^.*(D|d)(O|o) (N|n)(O|o)(T|t) (S|s)(U|u)(B|b)(M|m)(I|i)(T|t).*\""
          }
        },
        "submittabilityExpression": {
          "expressionString": "is:false"
        },
        "overrideExpression": {},
        "allowOverrideInChildProjects": false
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"message:\"^.*(D|d)(O|o) (N|n)(O|o)(T|t) (S|s)(U|u)(B|b)(M|m)(I|i)(T|t).*\""},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["message:\"^.*(D|d)(O|o) (N|n)(O|o)(T|t) (S|s)(U|u)(B|b)(M|m)(I|i)(T|t).*\""]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:false"},"status":"NOT_EVALUATED","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":[]}
      },
      "overrideExpressionResult": {},
      "patchSetCommitId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "No-Unresolved-Comments",
        "description": {
          "value": "Changes that have unresolved comments are not submittable. Unless overriden by adding the hashtag allow-unresolved-comments."
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "has:unresolved"
          }
        },
        "submittabilityExpression": {
          "expressionString": "-has:unresolved"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "hashtag:allow-unresolved-comments"
          }
        },
        "allowOverrideInChildProjects": false
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"has:unresolved"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["has:unresolved"]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"-has:unresolved"},"status":"NOT_EVALUATED","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":[]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"hashtag:allow-unresolved-comments"},"status":"NOT_EVALUATED","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":[]}
      },
      "patchSetCommitId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Review-Enforcement",
        "description": {
          "value": "Two Google employees must approve the change. Uploading the change or voting positively on Code-Review count as approval."
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "is:review-enforced_gerrit"
          }
        },
        "submittabilityExpression": {
          "expressionString": "is:review-enforcement-satisfied_gerrit"
        },
        "overrideExpression": {},
        "allowOverrideInChildProjects": false
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforced_gerrit"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["is:review-enforced_gerrit"]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforcement-satisfied_gerrit"},"status":"NOT_EVALUATED","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":[]}
      },
      "overrideExpressionResult": {},
      "patchSetCommitId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Verified",
        "description": {
          "value": "CI result status for build and tests is passing"
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "-branch:refs/meta/config"
          }
        },
        "submittabilityExpression": {
          "expressionString": "label:Verified\u003dMAX AND -label:Verified\u003dMIN"
        },
        "overrideExpression": {},
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"-branch:refs/meta/config"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["branch:refs/meta/config"]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Verified=MAX AND -label:Verified=MIN"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["label:Verified=MAX"],"failingAtoms":["label:Verified=MIN"]}
      },
      "overrideExpressionResult": {},
      "patchSetCommitId": "aee576673201b0fc1101e8eb6e28389f7aa665f5",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    }
  ]
}